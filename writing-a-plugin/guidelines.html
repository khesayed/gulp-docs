<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>Guidelines &#xB7; Gulp Documentation</title><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content=""><meta name="generator" content="GitBook 3.2.2"><link rel="stylesheet" href="../gitbook/bundle.css"><meta name="HandheldFriendly" content="true"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png"><link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon"><link rel="next" href="using-buffers.html"><link rel="prev" href="./"></head><body><div class="book"><div class="book-summary"><div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div><nav role="navigation"><ul class="summary"><li class="chapter" data-level="1.1" data-path="../"><a href="../">Introduction</a></li><li class="chapter" data-level="1.2" data-path="../getting-started.html"><a href="../getting-started.html">Getting Started</a></li><li class="chapter" data-level="1.3" data-path="../API.html"><a href="../API.html">API</a></li><li class="chapter" data-level="1.4" data-path="../CLI.html"><a href="../CLI.html">CLI</a></li><li class="chapter" data-level="1.5" data-path="./"><a href="./">Writing a Plugin</a><ul class="articles"><li class="chapter active" data-level="1.5.1" data-path="guidelines.html"><a href="guidelines.html">Guidelines</a></li><li class="chapter" data-level="1.5.2" data-path="using-buffers.html"><a href="using-buffers.html">Using buffers</a></li><li class="chapter" data-level="1.5.3" data-path="dealing-with-streams.html"><a href="dealing-with-streams.html">Dealing with streams</a></li><li class="chapter" data-level="1.5.4" data-path="testing.html"><a href="testing.html">Testing</a></li><li class="chapter" data-level="1.5.5" data-path="recommended-modules.html"><a href="recommended-modules.html">Recommended Modules</a></li></ul></li><li class="chapter" data-level="1.6" data-path="../FAQ.html"><a href="../FAQ.html">FAQ</a></li><li class="chapter" data-level="1.7" data-path="../recipes/"><a href="../recipes/">Recipes</a><ul class="articles"><li class="chapter" data-level="1.7.1" data-path="../recipes/automate-release-workflow.html"><a href="../recipes/automate-release-workflow.html">Automate release workflow</a></li><li class="chapter" data-level="1.7.2" data-path="../recipes/combining-streams-to-handle-errors.html"><a href="../recipes/combining-streams-to-handle-errors.html">Combining streams to handle errors</a></li><li class="chapter" data-level="1.7.3" data-path="../recipes/delete-files-folder.html"><a href="../recipes/delete-files-folder.html">Delete files and folders</a></li><li class="chapter" data-level="1.7.4" data-path="../recipes/fast-browserify-builds-with-watchify.html"><a href="../recipes/fast-browserify-builds-with-watchify.html">Fast browserify builds with watchify</a></li><li class="chapter" data-level="1.7.5" data-path="../recipes/incremental-builds-with-concatenate.html"><a href="../recipes/incremental-builds-with-concatenate.html">Incremental rebuilding, including operating on full file sets</a></li><li class="chapter" data-level="1.7.6" data-path="../recipes/make-stream-from-buffer.html"><a href="../recipes/make-stream-from-buffer.html">Make stream from buffer (memory contents)</a></li><li class="chapter" data-level="1.7.7" data-path="../recipes/mocha-test-runner-with-gulp.html"><a href="../recipes/mocha-test-runner-with-gulp.html">Mocha test-runner with gulp</a></li><li class="chapter" data-level="1.7.8" data-path="../recipes/only-pass-through-changed-files.html"><a href="../recipes/only-pass-through-changed-files.html">Only pass through changed files</a></li><li class="chapter" data-level="1.7.9" data-path="../recipes/pass-arguments-from-cli.html"><a href="../recipes/pass-arguments-from-cli.html">Pass parameters from the command line</a></li><li class="chapter" data-level="1.7.10" data-path="../recipes/rebuild-only-files-that-change.html"><a href="../recipes/rebuild-only-files-that-change.html">Rebuild only files that change</a></li><li class="chapter" data-level="1.7.11" data-path="../recipes/running-task-steps-per-folder.html"><a href="../recipes/running-task-steps-per-folder.html">Generating a file per folder</a></li><li class="chapter" data-level="1.7.12" data-path="../recipes/running-tasks-in-series.html"><a href="../recipes/running-tasks-in-series.html">Running tasks in series</a></li><li class="chapter" data-level="1.7.13" data-path="../recipes/server-with-livereload-and-css-injection.html"><a href="../recipes/server-with-livereload-and-css-injection.html">Server with live-reloading and CSS injection</a></li><li class="chapter" data-level="1.7.14" data-path="../recipes/sharing-streams-with-stream-factories.html"><a href="../recipes/sharing-streams-with-stream-factories.html">Sharing streams with stream factories</a></li><li class="chapter" data-level="1.7.15" data-path="../recipes/specifying-a-cwd.html"><a href="../recipes/specifying-a-cwd.html">Specifying a new cwd (current working directory)</a></li><li class="chapter" data-level="1.7.16" data-path="../recipes/split-tasks-across-multiple-files.html"><a href="../recipes/split-tasks-across-multiple-files.html">Split tasks across multiple files</a></li><li class="chapter" data-level="1.7.17" data-path="../recipes/using-external-config-file.html"><a href="../recipes/using-external-config-file.html">Using external config file</a></li><li class="chapter" data-level="1.7.18" data-path="../recipes/using-multiple-sources-in-one-task.html"><a href="../recipes/using-multiple-sources-in-one-task.html">Using multiple sources in one task</a></li><li class="chapter" data-level="1.7.19" data-path="../recipes/browserify-transforms.html"><a href="../recipes/browserify-transforms.html">Browserify + Transforms</a></li><li class="chapter" data-level="1.7.20" data-path="../recipes/browserify-uglify-sourcemap.html"><a href="../recipes/browserify-uglify-sourcemap.html">Browserify + Uglify with sourcemaps</a></li><li class="chapter" data-level="1.7.21" data-path="../recipes/browserify-with-globs.html"><a href="../recipes/browserify-with-globs.html">Browserify + Globs</a></li><li class="chapter" data-level="1.7.22" data-path="../recipes/browserify-multiple-destination.html"><a href="../recipes/browserify-multiple-destination.html">Browserify + Globs (multiple destination)</a></li><li class="chapter" data-level="1.7.23" data-path="../recipes/minified-and-non-minified.html"><a href="../recipes/minified-and-non-minified.html">Output both a minified and non-minified version</a></li><li class="chapter" data-level="1.7.24" data-path="../recipes/templating-with-swig-and-yaml-front-matter.html"><a href="../recipes/templating-with-swig-and-yaml-front-matter.html">Templating with Swig and YAML front-matter</a></li><li class="chapter" data-level="1.7.25" data-path="../recipes/handling-the-delete-event-on-watch.html"><a href="../recipes/handling-the-delete-event-on-watch.html">Handling the Delete Event on Watch</a></li><li class="chapter" data-level="1.7.26" data-path="../recipes/maintain-directory-structure-while-globbing.html"><a href="../recipes/maintain-directory-structure-while-globbing.html">Maintain Directory Structure while Globbing</a></li><li class="chapter" data-level="1.7.27" data-path="../recipes/run-grunt-tasks-from-gulp.html"><a href="../recipes/run-grunt-tasks-from-gulp.html">Run Grunt Tasks from Gulp</a></li><li class="chapter" data-level="1.7.28" data-path="../recipes/exports-as-tasks.html"><a href="../recipes/exports-as-tasks.html">Exports as tasks</a></li><li class="chapter" data-level="1.7.29" data-path="../recipes/rollup-with-rollup-stream.html"><a href="../recipes/rollup-with-rollup-stream.html">Rollup with rollup-stream</a></li></ul></li><li class="divider"></li><li><a href="https://www.gitbook.com" target="blank" class="gitbook-link">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header" role="navigation"><!-- Title --><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="..">Guidelines</a></h1></div><div class="page-wrapper" tabindex="-1" role="main"><div class="page-inner"><div id="book-search-results"><div class="search-noresults"><section class="normal markdown-section"><h1 id="guidelines">Guidelines</h1><blockquote><p>While these guidelines are totally optional, we <strong>HIGHLY</strong> recommend that everyone follows them. Nobody wants to use a bad plugin. These guidelines will actually help make your life easier by giving you assurance that your plugin fits well within gulp.</p></blockquote><p><a href="./">Writing a Plugin</a> &gt; Guidelines</p><ol><li>Your plugin should not do something that can be done easily with an existing node module<ul><li>For example: deleting a folder does not need to be a gulp plugin. Use a module like <a href="https://github.com/sindresorhus/del" target="_blank">del</a> within a task instead.</li><li>Wrapping every possible thing just for the sake of wrapping it will pollute the ecosystem with low quality plugins that don&apos;t make sense within the gulp paradigm.</li><li>gulp plugins are for file-based operations! If you find yourself shoehorning a complex process into streams just make a normal node module instead.</li><li>A good example of a gulp plugin would be something like gulp-coffee. The coffee-script module does not work with Vinyl out of the box, so we wrap it to add this functionality and abstract away pain points to make it work well within gulp.</li></ul></li><li>Your plugin should only do <strong>one thing</strong>, and do it well.<ul><li>Avoid config options that make your plugin do completely different tasks</li><li>For example: A JS minification plugin should not have an option that adds a header as well</li></ul></li><li>Your plugin shouldn&apos;t do things that other plugins are responsible for<ul><li>It should not concat, <a href="https://github.com/contra/gulp-concat" target="_blank">gulp-concat</a> does that</li><li>It should not add headers, <a href="https://github.com/godaddy/gulp-header" target="_blank">gulp-header</a> does that</li><li>It should not add footers, <a href="https://github.com/godaddy/gulp-footer" target="_blank">gulp-footer</a> does that</li><li>If it&apos;s a common but optional use case, document that your plugin is often used with another plugin</li><li>Make use of other plugins within your plugin! This reduces the amount of code you have to write and ensures a stable ecosystem.</li></ul></li><li>Your plugin <strong>must be tested</strong><ul><li>Testing a gulp plugin is easy, you don&apos;t even need gulp to test it</li><li>Look at other plugins for examples</li></ul></li><li>Add <code>gulpplugin</code> as a keyword in your <code>package.json</code> so you show up on our search</li><li>Your plugin API should be a function that returns a stream<ul><li>If you need to store state somewhere, do it internally</li><li>If you need to pass state/options between plugins, tack it on the file object</li></ul></li><li>Do not throw errors inside a stream<ul><li>Instead, you should emit it as an <strong>error</strong> event.</li><li>If you encounter an error <strong>outside</strong> the stream, such as invalid configuration while creating the stream, you may throw it.</li></ul></li><li>Prefix any errors with the name of your plugin<ul><li>For example: <code>gulp-replace: Cannot do regexp replace on a stream</code></li><li>Use gulp-util&apos;s <a href="https://github.com/gulpjs/gulp-util#new-pluginerrorpluginname-message-options" target="_blank">PluginError</a> class to make this easy</li></ul></li><li>Name your plugin appropriately: it should begin with &quot;gulp-&quot; if it is a gulp plugin<ul><li>If it is not a gulp plugin, it should not begin with &quot;gulp-&quot;</li></ul></li><li>The type of <code>file.contents</code> should always be the same going out as it was when it came in<ul><li>If file.contents is null (non-read) just ignore the file and pass it along</li><li>If file.contents is a Stream and you don&apos;t support that just emit an error<ul><li>Do not buffer a stream to shoehorn your plugin to work with streams. This will cause horrible things to happen.</li></ul></li></ul></li><li>Do not pass the <code>file</code> object downstream until you are done with it</li><li>Use <a href="https://github.com/gulpjs/vinyl#clone" target="_blank"><code>file.clone()</code></a> when cloning a file or creating a new one based on a file.</li><li>Use modules from our <a href="recommended-modules.html">recommended modules page</a> to make your life easier</li><li>Do NOT require <code>gulp</code> as a dependency or peerDependency in your plugin<ul><li>Using gulp to test or automate your plugin workflow is totally cool, just make sure you put it as a devDependency</li><li>Requiring gulp as a dependency of your plugin means that anyone who installs your plugin is also installing a new gulp and its entire dependency tree.</li><li>There is no reason you should be using gulp within your actual plugin code. If you find yourself doing this open an issue so we can help you out.</li></ul></li></ol><h2 id="why-are-these-guidelines-so-strict">Why are these guidelines so strict?</h2><p>gulp aims to be simple for users. By providing strict guidelines we are able to provide a consistent and high-quality ecosystem for everyone. While this does add a little more work and thought for plugin authors, it removes a lot of problems later down the road.</p><h3 id="what-happens-if-i-dont-follow-them">What happens if I don&apos;t follow them?</h3><p>npm is open for everyone, and you are free to make whatever you want but these guidelines were prescribed for a reason. There are acceptance tests coming soon that will be integrated into the plugin search. If you fail to adhere to the plugin guidelines it will be publicly visible/sortable via a scoring system. People will always prefer to use plugins that match &quot;the gulp way&quot;.</p><h3 id="what-does-a-good-plugin-look-like">What does a good plugin look like?</h3><pre><code class="lang-js"><span class="hljs-comment">// through2 is a thin wrapper around node transform streams</span>
<span class="hljs-keyword">var</span> through = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;through2&apos;</span>);
<span class="hljs-keyword">var</span> gutil = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;gulp-util&apos;</span>);
<span class="hljs-keyword">var</span> PluginError = gutil.PluginError;

<span class="hljs-comment">// Consts</span>
<span class="hljs-keyword">const</span> PLUGIN_NAME = <span class="hljs-string">&apos;gulp-prefixer&apos;</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prefixStream</span>(<span class="hljs-params">prefixText</span>) </span>{
  <span class="hljs-keyword">var</span> stream = through();
  stream.write(prefixText);
  <span class="hljs-keyword">return</span> stream;
}

<span class="hljs-comment">// Plugin level function(dealing with files)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gulpPrefixer</span>(<span class="hljs-params">prefixText</span>) </span>{

  <span class="hljs-keyword">if</span> (!prefixText) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> PluginError(PLUGIN_NAME, <span class="hljs-string">&apos;Missing prefix text!&apos;</span>);
  }
  prefixText = <span class="hljs-keyword">new</span> Buffer(prefixText); <span class="hljs-comment">// allocate ahead of time</span>

  <span class="hljs-comment">// Creating a stream through which each file will pass</span>
  <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">file, enc, cb</span>) </span>{
    <span class="hljs-keyword">if</span> (file.isNull()) {
      <span class="hljs-comment">// return empty file</span>
      <span class="hljs-keyword">return</span> cb(<span class="hljs-literal">null</span>, file);
    }
    <span class="hljs-keyword">if</span> (file.isBuffer()) {
      file.contents = Buffer.concat([prefixText, file.contents]);
    }
    <span class="hljs-keyword">if</span> (file.isStream()) {
      file.contents = file.contents.pipe(prefixStream(prefixText));
    }

    cb(<span class="hljs-literal">null</span>, file);

  });

}

<span class="hljs-comment">// Exporting the plugin main function</span>
<span class="hljs-built_in">module</span>.exports = gulpPrefixer;
</code></pre></section></div><div class="search-results"><div class="has-results"><h1 class="search-results-title"><span class="search-results-count"></span> results matching &quot;<span class="search-query"></span>&quot;</h1><ul class="search-results-list"></ul></div><div class="no-results"><h1 class="search-results-title">No results matching &quot;<span class="search-query"></span>&quot;</h1></div></div></div></div></div></div><a href="./" class="navigation navigation-prev" aria-label="Previous page: Writing a Plugin"><i class="fa fa-angle-left"></i> </a><a href="using-buffers.html" class="navigation navigation-next" aria-label="Next page: Using buffers"><i class="fa fa-angle-right"></i></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{title:"Guidelines",level:"1.5.1",depth:2,next:{title:"Using buffers",level:"1.5.2",depth:2,path:"writing-a-plugin/using-buffers.md",ref:"writing-a-plugin/using-buffers.md",articles:[]},previous:{title:"Writing a Plugin",level:"1.5",depth:1,path:"writing-a-plugin/README.md",ref:"writing-a-plugin/README.md",articles:[{title:"Guidelines",level:"1.5.1",depth:2,path:"writing-a-plugin/guidelines.md",ref:"writing-a-plugin/guidelines.md",articles:[]},{title:"Using buffers",level:"1.5.2",depth:2,path:"writing-a-plugin/using-buffers.md",ref:"writing-a-plugin/using-buffers.md",articles:[]},{title:"Dealing with streams",level:"1.5.3",depth:2,path:"writing-a-plugin/dealing-with-streams.md",ref:"writing-a-plugin/dealing-with-streams.md",articles:[]},{title:"Testing",level:"1.5.4",depth:2,path:"writing-a-plugin/testing.md",ref:"writing-a-plugin/testing.md",articles:[]},{title:"Recommended Modules",level:"1.5.5",depth:2,path:"writing-a-plugin/recommended-modules.md",ref:"writing-a-plugin/recommended-modules.md",articles:[]}]},dir:"ltr"},config:{plugins:["edit-link","ga","github","sitemap"],root:"./docs",styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},pluginsConfig:{github:{url:"https://github.com/bipedd/gulp-docs"},search:{},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},fontsettings:{theme:"white",family:"sans",size:2},highlight:{},sitemap:{hostname:"http://gulpjs.org/"},ga:{configuration:"auto",token:"UA-36637973-3"},sharing:{facebook:!1,twitter:!1,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"edit-link":{label:"",base:"https://github.com/bipedd/gulp-docs/blob/master/docs"},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1}},theme:"default",pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},variables:{},title:"Gulp Documentation",gitbook:"*",description:"Unofficial site for better reading experience of gulp documentation."},file:{path:"writing-a-plugin/guidelines.md",mtime:"2016-11-08T03:07:38.000Z",type:"markdown"},gitbook:{version:"3.2.2",time:"2016-11-08T03:25:53.783Z"},basePath:"..",book:{language:""}})})</script></div><script src="../gitbook/bundle.js"></script></body></html>